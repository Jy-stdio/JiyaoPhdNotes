# TV CS
![image-20230711142854053](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230711142854053.png)

> **摘要：**本文提出了一种用于辐射式欠采样欠采样MRI的迭代重建方法：
>
> （i）基于非线性优化，
>
> （ii）允许使用惩罚函数结合先验知识
>
> （iii）处理来自多个线圈的数据

> 本文的写法很像叙事，每一步的原因、动机、和分析都写的很详细，十分适合新手阅读！

> 文章中的专业词汇说明：
>
> 1. coil profiles：线圈敏感度

## THEORY

### 传统重建方法

传统方法对于辐射轨迹的MRI采集通常使用投影重建或重新划线方法进行重建（我们这里不详细研究）。下面举个例子说明这种方法的缺陷：

![图1 左：Radial欠采样； 右：来自402、64和24个轮辐/轮条的模拟欠采样数据重建结果（每个轮辐256个数据样本）](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713195214345.png)

图1中左图Radial欠采样，每一根采样线称为一个轮辐（spoke），每个spoke有256个采样点。根据参考文献[15]，对于$n\times n$采样点的图像，必须有$n\pi/2$个spokes。该标准确定了两个相邻spokes的最外面的样本具有最大的distance，即$\Delta k = \frac{1}{FOV}$，这和奈奎斯特采样定律是一致的。图1中右图来自402、64和24个轮辐/轮条的模拟欠采样数据使用**传统的投影重建或重新划线方法**重建的结果，但是由于采样频率降低都会产生条纹伪影。

### 基于反问题建模的辐射轨迹采样图像重建

反问题的建模这里就不赘述了，有兴趣的可以看看我之前的文章（[【Method】稀疏与压缩感知 | 图像稀疏性及压缩感知方法白话讲解](https://zhuanlan.zhihu.com/p/642740364)）或者看原文里具体的描述，再来看下面的公式便知。

我们的目标是求解最优$\overrightarrow{\mathbf{x}}$：

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713212803223.png)

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713212829597.png)

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713212840985.png)

但是由于公式[3]是一个欠定方程组，因此$\overrightarrow{\mathbf{x}}$的可行域是很大的。一种比较好的方法是共轭梯度法求解（此处也不做详解，重点关注之后的TV-CS方法）。

### 先验信息的正则化

上面我们简单介绍了把该重建问题建模为反问题的优化模型，但是存在条纹伪影，因为该过程在k空间中除了辐条的位置之外的任何其他位置都不测量估计的准确性，我们举一个例子具体说明：

![图2](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713213951044.png)

图2展示了只有两个辐条采样的k空间图像重建的结果。图2.a表示真实物体的样子，图2.b因为条纹伪影而退化。然而方程4似乎无法判断那种解决方案更好，因为二者的k空间使用两个辐条欠采样的结果模式相同。因此我们希望对优化目标——公式[4]加入某种质量衡量的惩罚（正则化）来提高优化的质量。

> 这种正则化有几点要求：①需要关于真实对象的先验知识；②不应该过于具体，保证问题的可优化性；③惩罚要是凸函数，保证能全局优化。
>
> 注意：由于观测一般会被噪声污染，搜索图像估计与测量数据的完美匹配通常不是一个好的策略。为了补偿这种影响，有必要根据所获取数据的信噪比来调整惩罚系数$\lambda_i$。

正则化如公式[7]所示：

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713214554867.png)

讲了这么多，终于步入正题，下面我们讲一讲本文的罚函数具体怎么设计：

① 罚函数1：FOV惩罚

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713215237194.png)

公式中cFOV表示圆形FOV。

② 罚函数2：约束目标$\overrightarrow{\mathbf{x}}$的参数空间为正。在一般图像恢复中非常有效的惩罚是将参数空间限制为正值。

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713220419545.png)

> 乍一看，负值的排除似乎理想地适用于MRI情况，其中测量的物理量，即通过某些弛豫过程调制的质子密度，是一个正单位。然而，不幸的是，使用具有复杂灵敏度分布的相控阵线圈以及物体内发生的相位变化阻碍了该标准的直接应用。在大多数成像情况下，图像的实部和虚部都不能被限制为正值。

③罚函数3： 总变化 total variation (TV)限制。该方法在参考文献[20]中已成功应用于图像恢复。

这个想法的基本假设是对象由具有恒定（或仅轻微变化）强度的区域组成，这在医学层析图像中相当适用。如果对象是分段恒定的，那么在辐射位置匹配的所有图像估计中，最好的表示应该是具有所有像素位置上最低导数的估计，即最小化总变差的估计。

> 上面这段话有点绕，一个直观地理解是该方法认为图像是具有一定的分段连续性的，因此我们期望重建的结果在所有像素上的导数之和最小，也就是重建之后的图像要尽可能平滑。

惩罚函数如公式[12]：

![image-20230713221222587](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713221222587.png)

$D_x,D_y$为$x,y$方向上的导数（一阶、二阶、......）。

因为图像是一个离散的，因此我们使用有限差分代替一阶导数：

![image-20230713224242305](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713224242305.png)

> 方程[12]中取模求和的操作类似$l_1$优化，有助于保持图像的边缘，主要惩罚振荡，这有助于已知吉布斯振铃伪影。如果用平方代替，则容易使得图像具有全局平滑度，导致丢失边缘。

然而简单使用一阶导数可能会重建出不完整的图像，因为其倾向生成具有恒定强度的区域。因此我们优选使用二阶导数，使得重建图像具有恒定强度梯度的图像区域。

![](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713230634992.png)

有时使用一阶和二阶导数的组合也是有利的。

![image-20230713231226860](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713231226860.png)

图3上排是24个辐条欠采样重建的结果，分别是通过传统regridding方法和本文的方法得到的结果对于模拟数据来说，条纹伪影已经被有效地去除。图3的下一行描述了相应的傅立叶变换。

### 多线圈辐射采样图像重建

当采用所描述的迭代策略来重建真实MRI数据时，又出现了两个困难：复数图像的非线性取模无法集成到欠采样矩阵/系统矩阵$A$中，并且现代MRI使用多相控阵列线圈，每个线圈具有不同的强度分布和可变的相位。

为此，提出了一种迭代的两步重建方法：第一步试图获得所有线圈的灵敏度，然后在第二步的迭代中使用这些灵敏度来组合单个线圈通道，并在频域和图像空间之间映射时每次去除相位。

在第一步中，来自所有线圈通道的信号被单独处理。实部和虚部被视为独立的参数，从而导致每个线圈通道的复值图像估计。众所周知，MRI线圈灵敏度是仅缓慢变化且不具有尖锐边缘的平滑函数。这一知识是通过使用图像导数的二次平方正则化来结合的，这导致了如前所述的全局平滑图像：

![image-20230713232056672](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230713232056672.png)

完成所有线圈迭代后将创建SOS图像（sum-of-squares image），然后利用SOS图像产生相应的线圈灵敏度图像。值得注意的是，这些估计的线圈轮灵敏度还包括与物体相关的相位变化，因为实值平方和图像已被用作参考。由于罚函数$R_{coil}(\overrightarrow{\mathbf{x}})$二次依赖于$\overrightarrow{\mathbf{x}}$，因此作为共轭梯度迭代的一部分的线搜索只需一步，只需少量迭代即可获得合理的图像。因此，线圈灵敏度估计步骤仅花费适度的计算时间。

对于第二重建步骤，来自所有线圈通道的原始数据被堆叠到数据向量$\overrightarrow{\mathbf{y}}$中，在对每个通道执行傅立叶变换之前，通过与相应的线圈敏感度相乘来扩展系统矩阵A。图5显示了系统矩阵A和伴随矩阵A#执行的在频率和图像空间之间映射的操作图。该算法呈现出符合来自所有线圈的观测结果的图像估计。此外，使用估计的线圈灵敏度以及基于非负性应用约束去除相位变化允许丢弃图像估计的虚部。值得注意的是，组合线圈重建确保了总变化约束在相控阵设置中仍然适用。否则，线圈轮廓的强度调制将与分段恒定图像的思想相冲突。

![图5 用于从图像域映射到频域，反之亦然的（左）系统矩阵A和（右）伴随系统矩阵A#的过程实现的示意图。](https://ossjiyaoliu.oss-cn-beijing.aliyuncs.com/uPic/image-20230714000756247.png)





