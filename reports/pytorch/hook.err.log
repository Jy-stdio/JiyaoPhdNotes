Traceback (most recent call last):
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/jupyter_cache/executors/utils.py", line 58, in single_nb_execution
    executenb(
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/nbclient/client.py", line 1305, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/jupyter_core/utils/__init__.py", line 166, in wrapped
    return loop.run_until_complete(inner)
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/nbclient/client.py", line 705, in async_execute
    await self.async_execute_cell(
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/nbclient/client.py", line 1058, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/liujiyao/miniforge3/envs/torchcpu/lib/python3.8/site-packages/nbclient/client.py", line 914, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
import timm
import torch
from torch import nn


def print_shape(m, i, o):
    #m: module, i: input, o: output
    # print(m, i[0].shape, o.shape)
    print(m, i[0].shape, '=>', o.shape)


def get_children(model: nn.Module):
    # get children form model!ï¼ˆé€’å½’ï¼‰
    children = list(model.children())
    flatt_children = []
    if children == []:
        # if model has no children; model is last child! :O
        return model
    else:
       # look for children from children... to the last child!
       for child in children:
            try:
                flatt_children.extend(get_children(child))
            except TypeError:
                flatt_children.append(get_children(child))
    return flatt_children


model_name = 'vgg11'
# model_name = 'resnet34'
model = timm.create_model(model_name, pretrained=True)

flatt_children = get_children(model)
for layer in flatt_children:
    layer.register_forward_hook(print_shape)

# for layer in model.children():
#     layer.register_forward_hook(print_shape)

# 4d: batch*channel*width*height
batch_input = torch.randn(4, 3, 300, 300)

model(batch_input)
------------------

----- stderr -----
'(MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/vgg11.tv_in1k/resolve/main/model.safetensors (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(54, 'Connection reset by peer')))"), '(Request ID: fcc26d6d-4522-4b61-873d-4fbe23adcf11)')' thrown while requesting HEAD https://huggingface.co/timm/vgg11.tv_in1k/resolve/main/model.safetensors
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mConnectionResetError[0m                      Traceback (most recent call last)
File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/connectionpool.py:711[0m, in [0;36mHTTPConnectionPool.urlopen[0;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)[0m
[1;32m    710[0m [38;5;28;01mif[39;00m is_new_proxy_conn [38;5;129;01mand[39;00m http_tunnel_required:
[0;32m--> 711[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_prepare_proxy[49m[43m([49m[43mconn[49m[43m)[49m
[1;32m    713[0m [38;5;66;03m# Make the request on the httplib connection object.[39;00m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/connectionpool.py:1007[0m, in [0;36mHTTPSConnectionPool._prepare_proxy[0;34m(self, conn)[0m
[1;32m   1005[0m     conn[38;5;241m.[39mtls_in_tls_required [38;5;241m=[39m [38;5;28;01mTrue[39;00m
[0;32m-> 1007[0m [43mconn[49m[38;5;241;43m.[39;49m[43mconnect[49m[43m([49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/connection.py:419[0m, in [0;36mHTTPSConnection.connect[0;34m(self)[0m
[1;32m    417[0m     context[38;5;241m.[39mload_default_certs()
[0;32m--> 419[0m [38;5;28mself[39m[38;5;241m.[39msock [38;5;241m=[39m [43mssl_wrap_socket[49m[43m([49m
[1;32m    420[0m [43m    [49m[43msock[49m[38;5;241;43m=[39;49m[43mconn[49m[43m,[49m
[1;32m    421[0m [43m    [49m[43mkeyfile[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mkey_file[49m[43m,[49m
[1;32m    422[0m [43m    [49m[43mcertfile[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mcert_file[49m[43m,[49m
[1;32m    423[0m [43m    [49m[43mkey_password[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mkey_password[49m[43m,[49m
[1;32m    424[0m [43m    [49m[43mca_certs[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mca_certs[49m[43m,[49m
[1;32m    425[0m [43m    [49m[43mca_cert_dir[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mca_cert_dir[49m[43m,[49m
[1;32m    426[0m [43m    [49m[43mca_cert_data[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mca_cert_data[49m[43m,[49m
[1;32m    427[0m [43m    [49m[43mserver_hostname[49m[38;5;241;43m=[39;49m[43mserver_hostname[49m[43m,[49m
[1;32m    428[0m [43m    [49m[43mssl_context[49m[38;5;241;43m=[39;49m[43mcontext[49m[43m,[49m
[1;32m    429[0m [43m    [49m[43mtls_in_tls[49m[38;5;241;43m=[39;49m[43mtls_in_tls[49m[43m,[49m
[1;32m    430[0m [43m[49m[43m)[49m
[1;32m    432[0m [38;5;66;03m# If we're using all defaults and the connection[39;00m
[1;32m    433[0m [38;5;66;03m# is TLSv1 or TLSv1.1 we throw a DeprecationWarning[39;00m
[1;32m    434[0m [38;5;66;03m# for the host.[39;00m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/util/ssl_.py:449[0m, in [0;36mssl_wrap_socket[0;34m(sock, keyfile, certfile, cert_reqs, ca_certs, server_hostname, ssl_version, ciphers, ssl_context, ca_cert_dir, key_password, ca_cert_data, tls_in_tls)[0m
[1;32m    448[0m [38;5;28;01mif[39;00m send_sni:
[0;32m--> 449[0m     ssl_sock [38;5;241m=[39m [43m_ssl_wrap_socket_impl[49m[43m([49m
[1;32m    450[0m [43m        [49m[43msock[49m[43m,[49m[43m [49m[43mcontext[49m[43m,[49m[43m [49m[43mtls_in_tls[49m[43m,[49m[43m [49m[43mserver_hostname[49m[38;5;241;43m=[39;49m[43mserver_hostname[49m
[1;32m    451[0m [43m    [49m[43m)[49m
[1;32m    452[0m [38;5;28;01melse[39;00m:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/util/ssl_.py:493[0m, in [0;36m_ssl_wrap_socket_impl[0;34m(sock, ssl_context, tls_in_tls, server_hostname)[0m
[1;32m    492[0m [38;5;28;01mif[39;00m server_hostname:
[0;32m--> 493[0m     [38;5;28;01mreturn[39;00m [43mssl_context[49m[38;5;241;43m.[39;49m[43mwrap_socket[49m[43m([49m[43msock[49m[43m,[49m[43m [49m[43mserver_hostname[49m[38;5;241;43m=[39;49m[43mserver_hostname[49m[43m)[49m
[1;32m    494[0m [38;5;28;01melse[39;00m:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/ssl.py:500[0m, in [0;36mSSLContext.wrap_socket[0;34m(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)[0m
[1;32m    494[0m [38;5;28;01mdef[39;00m [38;5;21mwrap_socket[39m([38;5;28mself[39m, sock, server_side[38;5;241m=[39m[38;5;28;01mFalse[39;00m,
[1;32m    495[0m                 do_handshake_on_connect[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    496[0m                 suppress_ragged_eofs[38;5;241m=[39m[38;5;28;01mTrue[39;00m,
[1;32m    497[0m                 server_hostname[38;5;241m=[39m[38;5;28;01mNone[39;00m, session[38;5;241m=[39m[38;5;28;01mNone[39;00m):
[1;32m    498[0m     [38;5;66;03m# SSLSocket class handles server_hostname encoding before it calls[39;00m
[1;32m    499[0m     [38;5;66;03m# ctx._wrap_socket()[39;00m
[0;32m--> 500[0m     [38;5;28;01mreturn[39;00m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msslsocket_class[49m[38;5;241;43m.[39;49m[43m_create[49m[43m([49m
[1;32m    501[0m [43m        [49m[43msock[49m[38;5;241;43m=[39;49m[43msock[49m[43m,[49m
[1;32m    502[0m [43m        [49m[43mserver_side[49m[38;5;241;43m=[39;49m[43mserver_side[49m[43m,[49m
[1;32m    503[0m [43m        [49m[43mdo_handshake_on_connect[49m[38;5;241;43m=[39;49m[43mdo_handshake_on_connect[49m[43m,[49m
[1;32m    504[0m [43m        [49m[43msuppress_ragged_eofs[49m[38;5;241;43m=[39;49m[43msuppress_ragged_eofs[49m[43m,[49m
[1;32m    505[0m [43m        [49m[43mserver_hostname[49m[38;5;241;43m=[39;49m[43mserver_hostname[49m[43m,[49m
[1;32m    506[0m [43m        [49m[43mcontext[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m
[1;32m    507[0m [43m        [49m[43msession[49m[38;5;241;43m=[39;49m[43msession[49m
[1;32m    508[0m [43m    [49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/ssl.py:1040[0m, in [0;36mSSLSocket._create[0;34m(cls, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, context, session)[0m
[1;32m   1039[0m             [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m([38;5;124m"[39m[38;5;124mdo_handshake_on_connect should not be specified for non-blocking sockets[39m[38;5;124m"[39m)
[0;32m-> 1040[0m         [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mdo_handshake[49m[43m([49m[43m)[49m
[1;32m   1041[0m [38;5;28;01mexcept[39;00m ([38;5;167;01mOSError[39;00m, [38;5;167;01mValueError[39;00m):

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/ssl.py:1309[0m, in [0;36mSSLSocket.do_handshake[0;34m(self, block)[0m
[1;32m   1308[0m         [38;5;28mself[39m[38;5;241m.[39msettimeout([38;5;28;01mNone[39;00m)
[0;32m-> 1309[0m     [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_sslobj[49m[38;5;241;43m.[39;49m[43mdo_handshake[49m[43m([49m[43m)[49m
[1;32m   1310[0m [38;5;28;01mfinally[39;00m:

[0;31mConnectionResetError[0m: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

[0;31mMaxRetryError[0m                             Traceback (most recent call last)
File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/requests/adapters.py:486[0m, in [0;36mHTTPAdapter.send[0;34m(self, request, stream, timeout, verify, cert, proxies)[0m
[1;32m    485[0m [38;5;28;01mtry[39;00m:
[0;32m--> 486[0m     resp [38;5;241m=[39m [43mconn[49m[38;5;241;43m.[39;49m[43murlopen[49m[43m([49m
[1;32m    487[0m [43m        [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mrequest[49m[38;5;241;43m.[39;49m[43mmethod[49m[43m,[49m
[1;32m    488[0m [43m        [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m
[1;32m    489[0m [43m        [49m[43mbody[49m[38;5;241;43m=[39;49m[43mrequest[49m[38;5;241;43m.[39;49m[43mbody[49m[43m,[49m
[1;32m    490[0m [43m        [49m[43mheaders[49m[38;5;241;43m=[39;49m[43mrequest[49m[38;5;241;43m.[39;49m[43mheaders[49m[43m,[49m
[1;32m    491[0m [43m        [49m[43mredirect[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    492[0m [43m        [49m[43massert_same_host[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    493[0m [43m        [49m[43mpreload_content[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    494[0m [43m        [49m[43mdecode_content[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    495[0m [43m        [49m[43mretries[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mmax_retries[49m[43m,[49m
[1;32m    496[0m [43m        [49m[43mtimeout[49m[38;5;241;43m=[39;49m[43mtimeout[49m[43m,[49m
[1;32m    497[0m [43m        [49m[43mchunked[49m[38;5;241;43m=[39;49m[43mchunked[49m[43m,[49m
[1;32m    498[0m [43m    [49m[43m)[49m
[1;32m    500[0m [38;5;28;01mexcept[39;00m (ProtocolError, [38;5;167;01mOSError[39;00m) [38;5;28;01mas[39;00m err:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/connectionpool.py:798[0m, in [0;36mHTTPConnectionPool.urlopen[0;34m(self, method, url, body, headers, retries, redirect, assert_same_host, timeout, pool_timeout, release_conn, chunked, body_pos, **response_kw)[0m
[1;32m    796[0m     e [38;5;241m=[39m ProtocolError([38;5;124m"[39m[38;5;124mConnection aborted.[39m[38;5;124m"[39m, e)
[0;32m--> 798[0m retries [38;5;241m=[39m [43mretries[49m[38;5;241;43m.[39;49m[43mincrement[49m[43m([49m
[1;32m    799[0m [43m    [49m[43mmethod[49m[43m,[49m[43m [49m[43murl[49m[43m,[49m[43m [49m[43merror[49m[38;5;241;43m=[39;49m[43me[49m[43m,[49m[43m [49m[43m_pool[49m[38;5;241;43m=[39;49m[38;5;28;43mself[39;49m[43m,[49m[43m [49m[43m_stacktrace[49m[38;5;241;43m=[39;49m[43msys[49m[38;5;241;43m.[39;49m[43mexc_info[49m[43m([49m[43m)[49m[43m[[49m[38;5;241;43m2[39;49m[43m][49m
[1;32m    800[0m [43m[49m[43m)[49m
[1;32m    801[0m retries[38;5;241m.[39msleep()

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/urllib3/util/retry.py:592[0m, in [0;36mRetry.increment[0;34m(self, method, url, response, error, _pool, _stacktrace)[0m
[1;32m    591[0m [38;5;28;01mif[39;00m new_retry[38;5;241m.[39mis_exhausted():
[0;32m--> 592[0m     [38;5;28;01mraise[39;00m MaxRetryError(_pool, url, error [38;5;129;01mor[39;00m ResponseError(cause))
[1;32m    594[0m log[38;5;241m.[39mdebug([38;5;124m"[39m[38;5;124mIncremented Retry for (url=[39m[38;5;124m'[39m[38;5;132;01m%s[39;00m[38;5;124m'[39m[38;5;124m): [39m[38;5;132;01m%r[39;00m[38;5;124m"[39m, url, new_retry)

[0;31mMaxRetryError[0m: HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/vgg11.tv_in1k/resolve/main/model.safetensors (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(54, 'Connection reset by peer')))

During handling of the above exception, another exception occurred:

[0;31mProxyError[0m                                Traceback (most recent call last)
Cell [0;32mIn[1], line 31[0m
[1;32m     29[0m model_name [38;5;241m=[39m [38;5;124m'[39m[38;5;124mvgg11[39m[38;5;124m'[39m
[1;32m     30[0m [38;5;66;03m# model_name = 'resnet34'[39;00m
[0;32m---> 31[0m model [38;5;241m=[39m [43mtimm[49m[38;5;241;43m.[39;49m[43mcreate_model[49m[43m([49m[43mmodel_name[49m[43m,[49m[43m [49m[43mpretrained[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m)[49m
[1;32m     33[0m flatt_children [38;5;241m=[39m get_children(model)
[1;32m     34[0m [38;5;28;01mfor[39;00m layer [38;5;129;01min[39;00m flatt_children:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/_factory.py:114[0m, in [0;36mcreate_model[0;34m(model_name, pretrained, pretrained_cfg, pretrained_cfg_overlay, checkpoint_path, scriptable, exportable, no_jit, **kwargs)[0m
[1;32m    112[0m create_fn [38;5;241m=[39m model_entrypoint(model_name)
[1;32m    113[0m [38;5;28;01mwith[39;00m set_layer_config(scriptable[38;5;241m=[39mscriptable, exportable[38;5;241m=[39mexportable, no_jit[38;5;241m=[39mno_jit):
[0;32m--> 114[0m     model [38;5;241m=[39m [43mcreate_fn[49m[43m([49m
[1;32m    115[0m [43m        [49m[43mpretrained[49m[38;5;241;43m=[39;49m[43mpretrained[49m[43m,[49m
[1;32m    116[0m [43m        [49m[43mpretrained_cfg[49m[38;5;241;43m=[39;49m[43mpretrained_cfg[49m[43m,[49m
[1;32m    117[0m [43m        [49m[43mpretrained_cfg_overlay[49m[38;5;241;43m=[39;49m[43mpretrained_cfg_overlay[49m[43m,[49m
[1;32m    118[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    119[0m [43m    [49m[43m)[49m
[1;32m    121[0m [38;5;28;01mif[39;00m checkpoint_path:
[1;32m    122[0m     load_checkpoint(model, checkpoint_path)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/vgg.py:238[0m, in [0;36mvgg11[0;34m(pretrained, **kwargs)[0m
[1;32m    234[0m [38;5;250m[39m[38;5;124mr[39m[38;5;124;03m"""VGG 11-layer model (configuration "A") from[39;00m
[1;32m    235[0m [38;5;124;03m`"Very Deep Convolutional Networks For Large-Scale Image Recognition" <https://arxiv.org/pdf/1409.1556.pdf>`._[39;00m
[1;32m    236[0m [38;5;124;03m"""[39;00m
[1;32m    237[0m model_args [38;5;241m=[39m [38;5;28mdict[39m([38;5;241m*[39m[38;5;241m*[39mkwargs)
[0;32m--> 238[0m [38;5;28;01mreturn[39;00m [43m_create_vgg[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43mvgg11[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[43mpretrained[49m[38;5;241;43m=[39;49m[43mpretrained[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mmodel_args[49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/vgg.py:197[0m, in [0;36m_create_vgg[0;34m(variant, pretrained, **kwargs)[0m
[1;32m    195[0m [38;5;66;03m# NOTE: VGG is one of few models with stride==1 features w/ 6 out_indices [0..5][39;00m
[1;32m    196[0m out_indices [38;5;241m=[39m kwargs[38;5;241m.[39mpop([38;5;124m'[39m[38;5;124mout_indices[39m[38;5;124m'[39m, ([38;5;241m0[39m, [38;5;241m1[39m, [38;5;241m2[39m, [38;5;241m3[39m, [38;5;241m4[39m, [38;5;241m5[39m))
[0;32m--> 197[0m model [38;5;241m=[39m [43mbuild_model_with_cfg[49m[43m([49m
[1;32m    198[0m [43m    [49m[43mVGG[49m[43m,[49m
[1;32m    199[0m [43m    [49m[43mvariant[49m[43m,[49m
[1;32m    200[0m [43m    [49m[43mpretrained[49m[43m,[49m
[1;32m    201[0m [43m    [49m[43mmodel_cfg[49m[38;5;241;43m=[39;49m[43mcfgs[49m[43m[[49m[43mcfg[49m[43m][49m[43m,[49m
[1;32m    202[0m [43m    [49m[43mfeature_cfg[49m[38;5;241;43m=[39;49m[38;5;28;43mdict[39;49m[43m([49m[43mflatten_sequential[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m[43m [49m[43mout_indices[49m[38;5;241;43m=[39;49m[43mout_indices[49m[43m)[49m[43m,[49m
[1;32m    203[0m [43m    [49m[43mpretrained_filter_fn[49m[38;5;241;43m=[39;49m[43m_filter_fn[49m[43m,[49m
[1;32m    204[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m,[49m
[1;32m    205[0m [43m[49m[43m)[49m
[1;32m    206[0m [38;5;28;01mreturn[39;00m model

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/_builder.py:397[0m, in [0;36mbuild_model_with_cfg[0;34m(model_cls, variant, pretrained, pretrained_cfg, pretrained_cfg_overlay, model_cfg, feature_cfg, pretrained_strict, pretrained_filter_fn, kwargs_filter, **kwargs)[0m
[1;32m    395[0m num_classes_pretrained [38;5;241m=[39m [38;5;241m0[39m [38;5;28;01mif[39;00m features [38;5;28;01melse[39;00m [38;5;28mgetattr[39m(model, [38;5;124m'[39m[38;5;124mnum_classes[39m[38;5;124m'[39m, kwargs[38;5;241m.[39mget([38;5;124m'[39m[38;5;124mnum_classes[39m[38;5;124m'[39m, [38;5;241m1000[39m))
[1;32m    396[0m [38;5;28;01mif[39;00m pretrained:
[0;32m--> 397[0m     [43mload_pretrained[49m[43m([49m
[1;32m    398[0m [43m        [49m[43mmodel[49m[43m,[49m
[1;32m    399[0m [43m        [49m[43mpretrained_cfg[49m[38;5;241;43m=[39;49m[43mpretrained_cfg[49m[43m,[49m
[1;32m    400[0m [43m        [49m[43mnum_classes[49m[38;5;241;43m=[39;49m[43mnum_classes_pretrained[49m[43m,[49m
[1;32m    401[0m [43m        [49m[43min_chans[49m[38;5;241;43m=[39;49m[43mkwargs[49m[38;5;241;43m.[39;49m[43mget[49m[43m([49m[38;5;124;43m'[39;49m[38;5;124;43min_chans[39;49m[38;5;124;43m'[39;49m[43m,[49m[43m [49m[38;5;241;43m3[39;49m[43m)[49m[43m,[49m
[1;32m    402[0m [43m        [49m[43mfilter_fn[49m[38;5;241;43m=[39;49m[43mpretrained_filter_fn[49m[43m,[49m
[1;32m    403[0m [43m        [49m[43mstrict[49m[38;5;241;43m=[39;49m[43mpretrained_strict[49m[43m,[49m
[1;32m    404[0m [43m    [49m[43m)[49m
[1;32m    406[0m [38;5;66;03m# Wrap the model in a feature extraction module if enabled[39;00m
[1;32m    407[0m [38;5;28;01mif[39;00m features:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/_builder.py:190[0m, in [0;36mload_pretrained[0;34m(model, pretrained_cfg, num_classes, in_chans, filter_fn, strict)[0m
[1;32m    188[0m         state_dict [38;5;241m=[39m load_state_dict_from_hf([38;5;241m*[39mpretrained_loc)
[1;32m    189[0m     [38;5;28;01melse[39;00m:
[0;32m--> 190[0m         state_dict [38;5;241m=[39m [43mload_state_dict_from_hf[49m[43m([49m[43mpretrained_loc[49m[43m)[49m
[1;32m    191[0m [38;5;28;01melse[39;00m:
[1;32m    192[0m     model_name [38;5;241m=[39m pretrained_cfg[38;5;241m.[39mget([38;5;124m'[39m[38;5;124marchitecture[39m[38;5;124m'[39m, [38;5;124m'[39m[38;5;124mthis model[39m[38;5;124m'[39m)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/timm/models/_hub.py:179[0m, in [0;36mload_state_dict_from_hf[0;34m(model_id, filename)[0m
[1;32m    177[0m [38;5;28;01mfor[39;00m safe_filename [38;5;129;01min[39;00m _get_safe_alternatives(filename):
[1;32m    178[0m     [38;5;28;01mtry[39;00m:
[0;32m--> 179[0m         cached_safe_file [38;5;241m=[39m [43mhf_hub_download[49m[43m([49m[43mrepo_id[49m[38;5;241;43m=[39;49m[43mhf_model_id[49m[43m,[49m[43m [49m[43mfilename[49m[38;5;241;43m=[39;49m[43msafe_filename[49m[43m,[49m[43m [49m[43mrevision[49m[38;5;241;43m=[39;49m[43mhf_revision[49m[43m)[49m
[1;32m    180[0m         _logger[38;5;241m.[39minfo(
[1;32m    181[0m             [38;5;124mf[39m[38;5;124m"[39m[38;5;124m[[39m[38;5;132;01m{[39;00mmodel_id[38;5;132;01m}[39;00m[38;5;124m] Safe alternative available for [39m[38;5;124m'[39m[38;5;132;01m{[39;00mfilename[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m [39m[38;5;124m"[39m
[1;32m    182[0m             [38;5;124mf[39m[38;5;124m"[39m[38;5;124m(as [39m[38;5;124m'[39m[38;5;132;01m{[39;00msafe_filename[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m). Loading weights using safetensors.[39m[38;5;124m"[39m)
[1;32m    183[0m         [38;5;28;01mreturn[39;00m safetensors[38;5;241m.[39mtorch[38;5;241m.[39mload_file(cached_safe_file, device[38;5;241m=[39m[38;5;124m"[39m[38;5;124mcpu[39m[38;5;124m"[39m)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/utils/_validators.py:118[0m, in [0;36mvalidate_hf_hub_args.<locals>._inner_fn[0;34m(*args, **kwargs)[0m
[1;32m    115[0m [38;5;28;01mif[39;00m check_use_auth_token:
[1;32m    116[0m     kwargs [38;5;241m=[39m smoothly_deprecate_use_auth_token(fn_name[38;5;241m=[39mfn[38;5;241m.[39m[38;5;18m__name__[39m, has_token[38;5;241m=[39mhas_token, kwargs[38;5;241m=[39mkwargs)
[0;32m--> 118[0m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/file_download.py:1232[0m, in [0;36mhf_hub_download[0;34m(repo_id, filename, subfolder, repo_type, revision, endpoint, library_name, library_version, cache_dir, local_dir, local_dir_use_symlinks, user_agent, force_download, force_filename, proxies, etag_timeout, resume_download, token, local_files_only, legacy_cache_layout)[0m
[1;32m   1230[0m [38;5;28;01mtry[39;00m:
[1;32m   1231[0m     [38;5;28;01mtry[39;00m:
[0;32m-> 1232[0m         metadata [38;5;241m=[39m [43mget_hf_file_metadata[49m[43m([49m
[1;32m   1233[0m [43m            [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m
[1;32m   1234[0m [43m            [49m[43mtoken[49m[38;5;241;43m=[39;49m[43mtoken[49m[43m,[49m
[1;32m   1235[0m [43m            [49m[43mproxies[49m[38;5;241;43m=[39;49m[43mproxies[49m[43m,[49m
[1;32m   1236[0m [43m            [49m[43mtimeout[49m[38;5;241;43m=[39;49m[43metag_timeout[49m[43m,[49m
[1;32m   1237[0m [43m        [49m[43m)[49m
[1;32m   1238[0m     [38;5;28;01mexcept[39;00m EntryNotFoundError [38;5;28;01mas[39;00m http_error:
[1;32m   1239[0m         [38;5;66;03m# Cache the non-existence of the file and raise[39;00m
[1;32m   1240[0m         commit_hash [38;5;241m=[39m http_error[38;5;241m.[39mresponse[38;5;241m.[39mheaders[38;5;241m.[39mget(HUGGINGFACE_HEADER_X_REPO_COMMIT)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/utils/_validators.py:118[0m, in [0;36mvalidate_hf_hub_args.<locals>._inner_fn[0;34m(*args, **kwargs)[0m
[1;32m    115[0m [38;5;28;01mif[39;00m check_use_auth_token:
[1;32m    116[0m     kwargs [38;5;241m=[39m smoothly_deprecate_use_auth_token(fn_name[38;5;241m=[39mfn[38;5;241m.[39m[38;5;18m__name__[39m, has_token[38;5;241m=[39mhas_token, kwargs[38;5;241m=[39mkwargs)
[0;32m--> 118[0m [38;5;28;01mreturn[39;00m [43mfn[49m[43m([49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/file_download.py:1599[0m, in [0;36mget_hf_file_metadata[0;34m(url, token, proxies, timeout)[0m
[1;32m   1596[0m headers[[38;5;124m"[39m[38;5;124mAccept-Encoding[39m[38;5;124m"[39m] [38;5;241m=[39m [38;5;124m"[39m[38;5;124midentity[39m[38;5;124m"[39m  [38;5;66;03m# prevent any compression => we want to know the real size of the file[39;00m
[1;32m   1598[0m [38;5;66;03m# Retrieve metadata[39;00m
[0;32m-> 1599[0m r [38;5;241m=[39m [43m_request_wrapper[49m[43m([49m
[1;32m   1600[0m [43m    [49m[43mmethod[49m[38;5;241;43m=[39;49m[38;5;124;43m"[39;49m[38;5;124;43mHEAD[39;49m[38;5;124;43m"[39;49m[43m,[49m
[1;32m   1601[0m [43m    [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m
[1;32m   1602[0m [43m    [49m[43mheaders[49m[38;5;241;43m=[39;49m[43mheaders[49m[43m,[49m
[1;32m   1603[0m [43m    [49m[43mallow_redirects[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m   1604[0m [43m    [49m[43mfollow_relative_redirects[49m[38;5;241;43m=[39;49m[38;5;28;43;01mTrue[39;49;00m[43m,[49m
[1;32m   1605[0m [43m    [49m[43mproxies[49m[38;5;241;43m=[39;49m[43mproxies[49m[43m,[49m
[1;32m   1606[0m [43m    [49m[43mtimeout[49m[38;5;241;43m=[39;49m[43mtimeout[49m[43m,[49m
[1;32m   1607[0m [43m[49m[43m)[49m
[1;32m   1608[0m hf_raise_for_status(r)
[1;32m   1610[0m [38;5;66;03m# Return[39;00m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/file_download.py:417[0m, in [0;36m_request_wrapper[0;34m(method, url, max_retries, base_wait_time, max_wait_time, timeout, follow_relative_redirects, **params)[0m
[1;32m    415[0m [38;5;66;03m# 2. Force relative redirection[39;00m
[1;32m    416[0m [38;5;28;01mif[39;00m follow_relative_redirects:
[0;32m--> 417[0m     response [38;5;241m=[39m [43m_request_wrapper[49m[43m([49m
[1;32m    418[0m [43m        [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m
[1;32m    419[0m [43m        [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m
[1;32m    420[0m [43m        [49m[43mmax_retries[49m[38;5;241;43m=[39;49m[43mmax_retries[49m[43m,[49m
[1;32m    421[0m [43m        [49m[43mbase_wait_time[49m[38;5;241;43m=[39;49m[43mbase_wait_time[49m[43m,[49m
[1;32m    422[0m [43m        [49m[43mmax_wait_time[49m[38;5;241;43m=[39;49m[43mmax_wait_time[49m[43m,[49m
[1;32m    423[0m [43m        [49m[43mtimeout[49m[38;5;241;43m=[39;49m[43mtimeout[49m[43m,[49m
[1;32m    424[0m [43m        [49m[43mfollow_relative_redirects[49m[38;5;241;43m=[39;49m[38;5;28;43;01mFalse[39;49;00m[43m,[49m
[1;32m    425[0m [43m        [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m,[49m
[1;32m    426[0m [43m    [49m[43m)[49m
[1;32m    428[0m     [38;5;66;03m# If redirection, we redirect only relative paths.[39;00m
[1;32m    429[0m     [38;5;66;03m# This is useful in case of a renamed repository.[39;00m
[1;32m    430[0m     [38;5;28;01mif[39;00m [38;5;241m300[39m [38;5;241m<[39m[38;5;241m=[39m response[38;5;241m.[39mstatus_code [38;5;241m<[39m[38;5;241m=[39m [38;5;241m399[39m:

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/file_download.py:452[0m, in [0;36m_request_wrapper[0;34m(method, url, max_retries, base_wait_time, max_wait_time, timeout, follow_relative_redirects, **params)[0m
[1;32m    449[0m     [38;5;28;01mreturn[39;00m response
[1;32m    451[0m [38;5;66;03m# 3. Exponential backoff[39;00m
[0;32m--> 452[0m [38;5;28;01mreturn[39;00m [43mhttp_backoff[49m[43m([49m
[1;32m    453[0m [43m    [49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m
[1;32m    454[0m [43m    [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m
[1;32m    455[0m [43m    [49m[43mmax_retries[49m[38;5;241;43m=[39;49m[43mmax_retries[49m[43m,[49m
[1;32m    456[0m [43m    [49m[43mbase_wait_time[49m[38;5;241;43m=[39;49m[43mbase_wait_time[49m[43m,[49m
[1;32m    457[0m [43m    [49m[43mmax_wait_time[49m[38;5;241;43m=[39;49m[43mmax_wait_time[49m[43m,[49m
[1;32m    458[0m [43m    [49m[43mretry_on_exceptions[49m[38;5;241;43m=[39;49m[43m([49m[43mTimeout[49m[43m,[49m[43m [49m[43mProxyError[49m[43m)[49m[43m,[49m
[1;32m    459[0m [43m    [49m[43mretry_on_status_codes[49m[38;5;241;43m=[39;49m[43m([49m[43m)[49m[43m,[49m
[1;32m    460[0m [43m    [49m[43mtimeout[49m[38;5;241;43m=[39;49m[43mtimeout[49m[43m,[49m
[1;32m    461[0m [43m    [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mparams[49m[43m,[49m
[1;32m    462[0m [43m[49m[43m)[49m

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/utils/_http.py:274[0m, in [0;36mhttp_backoff[0;34m(method, url, max_retries, base_wait_time, max_wait_time, retry_on_exceptions, retry_on_status_codes, **kwargs)[0m
[1;32m    271[0m     logger[38;5;241m.[39mwarning([38;5;124mf[39m[38;5;124m"[39m[38;5;124m'[39m[38;5;132;01m{[39;00merr[38;5;132;01m}[39;00m[38;5;124m'[39m[38;5;124m thrown while requesting [39m[38;5;132;01m{[39;00mmethod[38;5;132;01m}[39;00m[38;5;124m [39m[38;5;132;01m{[39;00murl[38;5;132;01m}[39;00m[38;5;124m"[39m)
[1;32m    273[0m     [38;5;28;01mif[39;00m nb_tries [38;5;241m>[39m max_retries:
[0;32m--> 274[0m         [38;5;28;01mraise[39;00m err
[1;32m    276[0m [38;5;66;03m# Sleep for X seconds[39;00m
[1;32m    277[0m logger[38;5;241m.[39mwarning([38;5;124mf[39m[38;5;124m"[39m[38;5;124mRetrying in [39m[38;5;132;01m{[39;00msleep_time[38;5;132;01m}[39;00m[38;5;124ms [Retry [39m[38;5;132;01m{[39;00mnb_tries[38;5;132;01m}[39;00m[38;5;124m/[39m[38;5;132;01m{[39;00mmax_retries[38;5;132;01m}[39;00m[38;5;124m].[39m[38;5;124m"[39m)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/utils/_http.py:258[0m, in [0;36mhttp_backoff[0;34m(method, url, max_retries, base_wait_time, max_wait_time, retry_on_exceptions, retry_on_status_codes, **kwargs)[0m
[1;32m    255[0m     kwargs[[38;5;124m"[39m[38;5;124mdata[39m[38;5;124m"[39m][38;5;241m.[39mseek(io_obj_initial_pos)
[1;32m    257[0m [38;5;66;03m# Perform request and return if status_code is not in the retry list.[39;00m
[0;32m--> 258[0m response [38;5;241m=[39m [43msession[49m[38;5;241;43m.[39;49m[43mrequest[49m[43m([49m[43mmethod[49m[38;5;241;43m=[39;49m[43mmethod[49m[43m,[49m[43m [49m[43murl[49m[38;5;241;43m=[39;49m[43murl[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    259[0m [38;5;28;01mif[39;00m response[38;5;241m.[39mstatus_code [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m retry_on_status_codes:
[1;32m    260[0m     [38;5;28;01mreturn[39;00m response

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/requests/sessions.py:589[0m, in [0;36mSession.request[0;34m(self, method, url, params, data, headers, cookies, files, auth, timeout, allow_redirects, proxies, hooks, stream, verify, cert, json)[0m
[1;32m    584[0m send_kwargs [38;5;241m=[39m {
[1;32m    585[0m     [38;5;124m"[39m[38;5;124mtimeout[39m[38;5;124m"[39m: timeout,
[1;32m    586[0m     [38;5;124m"[39m[38;5;124mallow_redirects[39m[38;5;124m"[39m: allow_redirects,
[1;32m    587[0m }
[1;32m    588[0m send_kwargs[38;5;241m.[39mupdate(settings)
[0;32m--> 589[0m resp [38;5;241m=[39m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43msend[49m[43m([49m[43mprep[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43msend_kwargs[49m[43m)[49m
[1;32m    591[0m [38;5;28;01mreturn[39;00m resp

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/requests/sessions.py:703[0m, in [0;36mSession.send[0;34m(self, request, **kwargs)[0m
[1;32m    700[0m start [38;5;241m=[39m preferred_clock()
[1;32m    702[0m [38;5;66;03m# Send the request[39;00m
[0;32m--> 703[0m r [38;5;241m=[39m [43madapter[49m[38;5;241;43m.[39;49m[43msend[49m[43m([49m[43mrequest[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m    705[0m [38;5;66;03m# Total elapsed time of the request (approximately)[39;00m
[1;32m    706[0m elapsed [38;5;241m=[39m preferred_clock() [38;5;241m-[39m start

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/huggingface_hub/utils/_http.py:63[0m, in [0;36mUniqueRequestIdAdapter.send[0;34m(self, request, *args, **kwargs)[0m
[1;32m     61[0m [38;5;250m[39m[38;5;124;03m"""Catch any RequestException to append request id to the error message for debugging."""[39;00m
[1;32m     62[0m [38;5;28;01mtry[39;00m:
[0;32m---> 63[0m     [38;5;28;01mreturn[39;00m [38;5;28;43msuper[39;49m[43m([49m[43m)[49m[38;5;241;43m.[39;49m[43msend[49m[43m([49m[43mrequest[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m
[1;32m     64[0m [38;5;28;01mexcept[39;00m requests[38;5;241m.[39mRequestException [38;5;28;01mas[39;00m e:
[1;32m     65[0m     request_id [38;5;241m=[39m request[38;5;241m.[39mheaders[38;5;241m.[39mget(X_AMZN_TRACE_ID)

File [0;32m~/miniforge3/envs/torchcpu/lib/python3.8/site-packages/requests/adapters.py:513[0m, in [0;36mHTTPAdapter.send[0;34m(self, request, stream, timeout, verify, cert, proxies)[0m
[1;32m    510[0m     [38;5;28;01mraise[39;00m RetryError(e, request[38;5;241m=[39mrequest)
[1;32m    512[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(e[38;5;241m.[39mreason, _ProxyError):
[0;32m--> 513[0m     [38;5;28;01mraise[39;00m ProxyError(e, request[38;5;241m=[39mrequest)
[1;32m    515[0m [38;5;28;01mif[39;00m [38;5;28misinstance[39m(e[38;5;241m.[39mreason, _SSLError):
[1;32m    516[0m     [38;5;66;03m# This branch is for urllib3 v1.22 and later.[39;00m
[1;32m    517[0m     [38;5;28;01mraise[39;00m SSLError(e, request[38;5;241m=[39mrequest)

[0;31mProxyError[0m: (MaxRetryError("HTTPSConnectionPool(host='huggingface.co', port=443): Max retries exceeded with url: /timm/vgg11.tv_in1k/resolve/main/model.safetensors (Caused by ProxyError('Cannot connect to proxy.', ConnectionResetError(54, 'Connection reset by peer')))"), '(Request ID: fcc26d6d-4522-4b61-873d-4fbe23adcf11)')

